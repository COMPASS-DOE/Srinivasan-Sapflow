#Import all data
full_data <- readRDS("Full_21_24.rds")
library(readr)
library(tidyr)
library(dplyr)
library(ggplot2)
library(lubridate)
library(ggpmisc)
#Import all data
full_data <- readRDS("Full_21_24.rds")
#Calculating average sap flow rates for each species:
full_data %>%
mutate(Hour = hour(TIMESTAMP),
Month = month(TIMESTAMP),
Date = date(TIMESTAMP)) %>%
filter(Year != 2024,
Hour >= 11, Hour <= 12,
Month >= 5, Month <= 9,
F <= 17500, F >= 0) -> gs_data
gs_data %>%
group_by(Species) %>%
summarize(avg_F = mean(F))
citation('tidyverse')
citation('tidyr')
gs_data %>%
group_by(Species, Plot) %>%
summarize(avg_F = mean(F))
gs_data %>%
group_by(Species) %>%
summarize(avg_F = mean(F))
#Calculating average sap flow rates for each species:
full_data %>%
mutate(Hour = hour(TIMESTAMP),
Month = month(TIMESTAMP),
Date = date(TIMESTAMP)) %>%
filter(Year != 2024, Year !=2021
Hour >= 11, Hour <= 12,
#Calculating average sap flow rates for each species:
full_data %>%
mutate(Hour = hour(TIMESTAMP),
Month = month(TIMESTAMP),
Date = date(TIMESTAMP)) %>%
filter(Year != 2024, Year !=2021,
Hour >= 11, Hour <= 12,
Month >= 5, Month <= 9,
F <= 17500, F >= 0) -> gs_data
gs_data %>%
group_by(Species) %>%
summarize(avg_F = mean(F))
gs_data %>%
group_by(Species, Plot) %>%
summarize(avg_F = mean(F))
gs_data %>%
group_by(Species, Plot) %>%
summarize(avg_F = mean(F)) %>%
filter(Plot != "Control") -> anova2
means_aov <- aov(avg_F ~ Species * Plot, data = anova2)
summary(means_aov)
gs_data %>%
group_by(Species, Plot) %>%
summarize(avg_F = mean(F)) %>%
t_test(weight ~ 1, mu = "Control")
gs_data %>%
group_by(Species, Plot) %>%
summarize(avg_F = mean(F)) -> test
t.test(avg_F ~ Plot, data = test, var.equal = TRUE)
gs_data %>%
group_by(Species, Plot) %>%
summarize(avg_F = mean(F)) %>%
filter(Plot != "Control") -> test
t.test(avg_F ~ Plot, data = test, var.equal = TRUE)
gs_data %>%
group_by(Species, Plot) %>%
summarize(avg_F = mean(F)) %>%
filter(Plot != "Freshwater") -> test
t.test(avg_F ~ Plot, data = test, var.equal = TRUE)
View(test)
t.test(avg_F ~ Plot, data = test, var.equal = FALSE)
aov(avg_F ~ Plot * Species, data = test, var.equal = FALSE)
gs_data %>%
group_by(Species, Plot) %>%
summarize(avg_F = mean(F)) %>%
filter(Plot != "Freshwater",
Species == "Red Maple") -> test
t.test(avg_F ~ Plot, data = test, var.equal = FALSE)
gs_data %>%
group_by(Species, Plot) %>%
summarize(avg_F = mean(F)) %>%
filter(Species == "Red Maple") -> test
t.test(avg_F ~ Plot, data = test, var.equal = FALSE)
#Import all data
full_data <- readRDS("Full_21_24.rds")
#Store storm events
Ida_start <- as_date("2021-08-26")
Ida_end <- as_date("2021-09-01")
Elsa_start <- as_date("2021-06-30")
Elsa_end <- as_date("2021-07-09")
#Pre and post-TEMPEST weeks for reference:
weeks_start <- c("2022-06-15", "2022-06-23", "2023-05-30", "2023-06-08", "2021-06-06", "2021-06-13")
weeks_end <- c("2022-06-21", "2022-06-29", "2023-06-05", "2023-06-14", "2021-06-12", "2021-06-19")
weeks_start<- as_date(weeks_start)
weeks_end<- as_date(weeks_end)
full_data %>%
mutate(Hour = hour(TIMESTAMP)) %>%
mutate(Date = date(TIMESTAMP)) %>%
mutate(Week = floor_date(TIMESTAMP, unit = "week")) %>%
filter(Hour >= 11, Hour <= 12) %>%
filter(F <= 17500, F > 0) %>%
group_by(Plot, Species, Date) %>%
summarise(F_avg = mean(F, na.rm = FALSE),
F_error = sd(F, na.rm = FALSE)) %>%
mutate(F_avg = round(F_avg, digits = 3)) -> sf_plot_avg
ggplot(sf_plot_avg) +
geom_point(aes (x = Date, y = F_avg, color = Species)) +
#geom_errorbar(aes(ymin = F_avg - F_error, ymax = F_avg + F_error,
#x = Date, color = Species)) +
facet_wrap(~Plot, ncol = 1, scales = "fixed") +
annotate(geom = "rect", xmin=Ida_start, xmax=Ida_end, ymin= -Inf, ymax=Inf, alpha=0.6, fill="lightblue") +
annotate(geom = "rect", xmin=Elsa_start, xmax=Elsa_end, ymin= -Inf, ymax=Inf, alpha=0.6, fill="lightgreen") +
labs(y = expression(Average~Sap~Flux~Density~(m^3/s)), x = "Date", title = "Sap Flux Density Averaged Daily, 11 AM - 12 PM")
ggsave("Daily_Sapflow.jpeg")
ggplot(sf_plot_avg) +
geom_point(aes (x = Date, y = F_avg, color = Species)) +
#geom_errorbar(aes(ymin = F_avg - F_error, ymax = F_avg + F_error,
#x = Date, color = Species)) +
facet_wrap(~Plot, ncol = 1, scales = "fixed") +
annotate(geom = "rect", xmin=Ida_start, xmax=Ida_end, ymin= -Inf, ymax=Inf, alpha=0.6, fill="lightblue") +
annotate(geom = "rect", xmin=Elsa_start, xmax=Elsa_end, ymin= -Inf, ymax=Inf, alpha=0.6, fill="lightblue") +
labs(y = expression(Average~Sap~Flux~Density~(m^3/s)), x = "Date", title = "Sap Flux Density Averaged Daily, 11 AM - 12 PM")
ggsave("Daily_Sapflow.jpeg")
ggplot(sf_plot_avg) +
geom_point(aes (x = Date, y = F_avg, color = Species)) +
#geom_errorbar(aes(ymin = F_avg - F_error, ymax = F_avg + F_error,
#x = Date, color = Species)) +
facet_wrap(~Plot, ncol = 1, scales = "fixed") +
annotate(geom = "rect", xmin=Ida_start, xmax=Ida_end, ymin= -Inf, ymax=Inf, alpha=0.6, fill="lightblue") +
annotate(geom = "rect", xmin=Elsa_start, xmax=Elsa_end, ymin= -Inf, ymax=Inf, alpha=0.6, fill="lightblue") +
labs(y = expression(Average~Sap~Flux~Density~(m^3/s)), x = "Date", title = "Sap Flux Density Averaged Daily, 11 AM - 12 PM")
